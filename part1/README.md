# Тема 1
## Оглавление
1. [Початкові налаштування](#r1)
2. [Локалізація](#r2)
3. [Додавання діалогових вікон](#r3)
    - [Самостійне додавання - НЕ РОЗГЛЯНУТО](#r3_1)
    - [Використання готового набору](#3_2)
6. [Посилання](#r6)
______


## <a name="r1">Початкові налаштування</a>
Необхідно завантажити та встановити
- WiX Toolset - https://wixtoolset.org/ За посиланням переходимо в секцію завантажень та знаходимо актуальну на зараз версію. Після цього потрапляємо на сторінку в git де в розділі асетів знаходимо та завантажуємо exe файл
- Компонент .NET Framework. Після запуску інсталяції WiX він може просигналізувати, що не вистачає цього компоненту та вкаже потрібну версію. ЇЇ можна нагуглити в прив'язці до потрібної версії ОС. Посилання варто брати з сайту Майкрософт
- Для інтеграції у VS знаходим розширення для потрібної версії студії тут https://marketplace.visualstudio.com/items?itemName=WixToolset.WiXToolset Завантажуємо та встановлюємо його
- При створенні проекту обираємо Setup Project for WiX

## <a name="r2">Локалізація</a>
Розглянемо локалізацію на прикладі додавання української мови:
- У файлі Product.wxs для ключа Language встановлюємо значення 1058, яке відповідає українській мові. Нажаль повнго списку цих ключів не знайшов навіть в офіційній документації. В цілому цей ключ використовується для встановлення мови локалізації для вихідного коду, що включає в себе текстові рядки, назви файлів та директорій, повідомлення, ярлики, та інші тексти.
- В налаштуваннях проекту *Solution Explorer -> Properties* на закладці *Build* в поле *Cultures to build* необхідно додати uk-UA. Повний перелік мов можна знайти тут: https://wixtoolset.org/docs/v3/wixui/wixui_localization/. В цілому дане налаштування використовується для вибору культур, для яких буде створюватися вихідний код та мовні пакети
- Далі необхідно налаштувати підтримку вибраної мови в інтерфейсі встановлення (для показу повідомлень та написів на кнопках та інших елементах). Для цього:
    - З репозиторія, з якого було викачано інсталер WiX (https://wixtoolset.org/) завантажумо архів wix311-debug.zip.
    - Розпаковуємо архів та переходимо до папки: wix311-debug.zip\src\ext\UIExtension\wixlib\
    - Копіюємо з неї файл WixUI_uk-UA.wxl в папку з проектом
    - Додаємо файл до проекту *Add -> Existing Item*

## <a name="r3">Додавання діалогових вікон</a>
Існує два варіанти додавання діалогових вікон. Самостійно або з використанням готового набору діалогових вікон.

### <a name="r3_1">Самостійне додавання</a>

### <a name="r3_2">Використання готового набору</a>

Щоб скористатись готовими діалоговими вікнами їх спочатку необхідно додати до проекту. Для цього:
- Додаємо в проекті посилання на *"C:\Program Files (x86)\WiX Toolset v3.11\bin\WixUIExtension.dll"* за допомогою *Add -> Reference*
- В кінці розділу Product вказуємо який набір буде використовуватись

~~~wix
<Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" ></Property>
<UIRef Id="WixUI_InstallDir"/>
~~~

Розберемо додані рядки:
- `Id="WIXUI_INSTALLDIR"` - ідентифікатор (по суті тип) який дозволяє зберігти шлях, вибраний користувачем для встановлення додатку
- `INSTALLLOCATION` -назва змінної, в якій зберігається вибраний шлях встановлення додатку (можна вибрати будь яку іншу назву)
- `UIRef` - по суті посилання на доданий раніше файл *WixUIExtension.dll*
- `Id="WixUI_InstallDir"` - набір елементів інтерфейсу, що відповідають етапу інсталяції додатку

В ціломуіснують наступні набори елементів інтерфейсу:
1. **WixUI_Advanced** - набір елементів управління для забезпечення більш розширених можливостей інсталяції, включаючи діалоги вибору властивостей, вибору компонентів та мов
2. **WixUI_Basic** - простий набір елементів управління, який містить діалоги для вибору мови та каталогу встановлення
3. **WixUI_InstallDir** - набір елементів управління, який містить діалог для вибору каталогу встановлення
4. **WixUI_FeatureTree** - набір елементів управління, який містить діалог для вибору функцій, які користувач може встановити або не встановити
5. **WixUI_Minimal** - мінімальний набір елементів управління, який містить лише діалог вибору каталогу встановлення.
6. **WixUI_Mondo** - набір елементів управління, який містить діалоги для вибору мови, каталогу встановлення, вибору функцій та налаштування опцій встановлення.
7. **WixUI_ProgressOnly** - набір елементів управління, який містить лише діалог відображення ходу встановлення.
8. **WixUI_Simple** - простий набір елементів управління, який містить діалоги для вибору мови та каталогу встановлення, а також діалог завершення встановлення.
9. **WixUI_Web** - набір елементів управління, який містить діалоги для вибору мови, каталогу встановлення, вибору функцій та введення налаштувань зв'язку з веб-сервером.

## <a name="r6">Посилання</a>
1. Стаття на хабрі: "Створення інсталятора за допомогою WiX. Частина 1" - https://habr.com/ru/articles/68616/
2. Послідовність встановлення WiX - https://www.educba.com/install-wix/ 
3. Документація по Product - https://wixtoolset.org/docs/v3/xsd/wix/product/